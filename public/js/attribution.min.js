function providePlugin(e,t){var i=window[window.GoogleAnalyticsObject||"ga"];i&&i("provide",e,t)}function get_intersect(e,t){var i,n,o=[],r={},a=t.length;for(i=0;a>i;i++)r[t[i]]=!0;for(a=e.length,i=0;a>i;i++)n=e[i],n in r&&o.push(n);return o}function read_cookie(e){var t=e+"=",i=String(document.cookie).split(";");for(var n in i){for(var o=String(i[n]);" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}function set_cookie(e,t,i,n){var o,r=new Date;r.setTime(r.getTime()+24*i*60*60*1e3),o="; expires="+r.toGMTString(),"none"==n?document.cookie=e+"="+t+o+";path=/;":document.cookie=e+"="+t+o+";path=/;domain="+n}var Attribution=function(e,t){this.tracker=e,this.current_timestamp=Math.round((new Date).getTime()/1e3),this.domain_name=this.tracker.get("cookieDomain")||document.domain,this.session_timeout=parseInt(60*(t.hours||0)*60,10)+parseInt(60*(t.minutes||30),10),this.campaign_timeout=parseInt(t.days||0,10)+parseInt(30*(t.months||6),10),this.landing_page_id=parseInt(document.getElementsByName(t.landing_page_id)[0].value),this.auth_key=document.getElementsByName(t.auth_key)[0].value,this.email=t.email,this.form_id=t.form_id,this.organic_sources=["google","daum","eniro","naver","yahoo","msn","bing","aol","lycos","ask","altavista","netscape","cnn","about","mamma","alltheweb","voila","virgilio","live","baidu","alice","yandex","najdi","mama","seznam","search","wirtulana polska","onetcenter","szukacz","yam","pchome","kvasir","sesam","ozu","terra","mynet","ekolay","rambler"],this.social_sources=["facebook","pinterest","twitter","buzzfeed","linkedin","blogger","blogspot","reddit","tumblr","stumbleupon","tinyurl","polyvore","youtube","yelp","cafemom","flickr","paper.li","wordpress","getpocket","weebly","delicious","netvibes","plurk","typepad","vk","allvoices","badoo","disqus","livefyre","d.hatena"],this.custom_social=["t.co","plus.google.com","plus.url.google.com","bookmarks.yahoo.com","answers.yahoo.com"],this._wma={tracking_id:"",timestamp:this.current_timestamp,source:"",medium:"",keyword:"",content:"",campaign:"",landing_page:window.location.href},this.url_parameters={utm_source:"source",utm_medium:"medium",utm_term:"keyword",utm_content:"content",utm_campaign:"campaign"},this.mediums=["none","referral","organic","social","paid"],this.init()};Attribution.prototype.init=function(){this.is_new_visitor()?(this._wma.tracking_id=parseInt(this.tracker.get("clientId").split(".")[0],10),this.get_info(),this.get_url_parameters(),set_cookie("_wma",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name),set_cookie("_wmb",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name)):this.is_new_session()&&(location.hostname==document.referrer.split("/")[2]&&(this._wma=JSON.parse(read_cookie("_wma"))),this._wma.tracking_id=parseInt(this.tracker.get("clientId").split(".")[0],10),this.get_info(),this.get_url_parameters(),set_cookie("_wma",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name)),this.set_event_listener()},Attribution.prototype.set_event_listener=function(){var e=document.getElementById(this.form_id),t=JSON.parse(read_cookie("_wma")),i=JSON.parse(read_cookie("_wmb")),n=this.email,o="?lp="+this.landing_page_id+"&ak="+this.auth_key+"&t="+t.tracking_id+"&cs="+t.source+"&cm="+t.medium+"&ck="+t.keyword+"&ccn="+t.content+"&cc="+t.campaign+"&cl="+encodeURIComponent(t.landing_page)+"&ct="+t.timestamp+"&os="+i.source+"&om="+i.medium+"&ok="+i.keyword+"&ocn="+i.content+"&oc="+i.campaign+"&ol="+i.landing_page+"&ot="+i.timestamp+"&r="+document.referrer;e.addEventListener?e.addEventListener("submit",function(e){o+="&em="+document.getElementsByName(n)[0].value;var t=document.createElement("img");t.src="http://107.170.197.75/pixel"+o},!1):e.attachEvent&&e.attachEvent("onsubmit",function(e){o+="&em="+document.getElementsByName(n)[0].value;var t=document.createElement("img");t.src="http://107.170.197.75/pixel"+o})},Attribution.prototype.is_new_visitor=function(){return null===JSON.parse(read_cookie("_wma"))?!0:!1},Attribution.prototype.is_new_session=function(){var e=JSON.parse(read_cookie("_wma"));return this.current_timestamp>parseInt(e.timestamp,10)+this.session_timeout?!0:!1},Attribution.prototype.get_info=function(){if(this._wma.timestamp=this.current_timestamp,void 0===document.referrer||"undefined"===document.referrer||""===document.referrer)this._wma.medium="none",this._wma.source="direct";else if(location.hostname!=document.referrer.split("/")[2]){this._wma.source=document.referrer.split("/")[2];var e=this._wma.source.split(".");if(this.custom_social.indexOf(this._wma.source)>0)this._wma.medium="social";else if(get_intersect(this.organic_sources,e).length>0){var t=this.get_url_parameters(document.URL);if("gclid"in t)this._wma.medium="paid";else{this._wma.medium="organic",this._wma.keyword="not provided";var i=this.get_url_parameters(document.referrer);"q"in i&&(this._wma.keyword=i.q)}}else get_intersect(this.social_sources,e).length>0?this._wma.medium="social":this._wma.medium="referral"}},Attribution.prototype.get_url_parameters=function(e){var t,i,n={};i=e?String(e.slice(e.indexOf("?")+1)).split("&"):String(window.location.href.slice(window.location.href.indexOf("?")+1)).split("&");for(var o in i)if(t=String(i[o]).split("="),n[t[0]]=t[1],t[0]in this.url_parameters){var r=this.url_parameters[t[0]];this._wma[r]=decodeURIComponent(t[1])}return n},providePlugin("Attribution",Attribution);
//# sourceMappingURL=attribution.min.js.map
